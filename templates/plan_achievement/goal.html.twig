{% extends 'base.html.twig' %}

{% block subTitle %}
	<li class="active">{% trans %}SMIS{% endtrans %}</li>
	<li class="active">
		<a href="{{path('plan_achievement_goal')}}">{% trans %}Goal Achievement{% endtrans %}</a>
	</li>
{% endblock %}

{% block body %}
	<div class="well well-sm">
		<form action="" id="reloadform" class="form-inline" method="post">
			<input type="hidden" name="reload" value="true">
			<button class="btn btn-white btn-info btn-bold btn-lg" id="reloadbtn" data-target="#widget-container-col-1" data-action="reload">
				<i class="ace-icon fa fa-refresh bigger-120 blue"></i>
				<strong>Reload</strong>
			</button>


		</form>
		{# <a href="#" data-action="reload">
																									<i class="ace-icon fa fa-refresh"></i>
																								</a> #}

	</div>
	<div class="col-sm-12 col-md-12 col-lg-12">
		<div class="tabbable">
			<ul class="nav nav-tabs nav-justified  tab-color-blue" id="myTab">
				<li class="active">
					<a data-toggle="tab" href="#home" class="lead" aria-expanded="true">

						<strong>{% trans %}Tabular{% endtrans %}</strong>
					</a>
				</li>

				<li class="">
					<a data-toggle="tab" href="#messages" aria-expanded="false" class="lead">
						<strong>{% trans %}Visualization{% endtrans %}</strong>

					</a>
				</li>


			</ul>
			{# <div id="wait" style="display:none;width:69px;height:89px;border:1px solid black;position:absolute;top:50%;left:50%;padding:2px;"><img src='{{asset('image/loading.gif')}}' width="64" height="64"/><br>Loading..</div> #}

			<div class="tab-content">
				<div id="home" class="tab-pane fade active in">
					<div class="row">
						<div class="col-sm-12 widget-container-col ui-sortable" id="widget-container-col-1">
							{# <div class="widget-box ui-sortable-handle" id="widget-box-1"> #}
							{# <div class="widget-header">
																<h5 class="widget-title">
																	<strong>Initiative Achievement</strong>
																</h5>
							
																<div class="widget-toolbar">
							
							
																	<a href="#" id="reload" data-action="reload">
																		<i class="ace-icon fa fa-refresh"></i>
																	</a>
							
							
																</div>
															</div> #}

								<div class="widget-body"> <div class="widget-main">
									<div class="table-responsive">
										<span class="badge badge-info pull-right">
											{% trans %}Total{% endtrans %}
											:
											<strong>{{ plan_achievements.getTotalItemCount()}}</strong>
										</span>
										<table class="table table-striped table-bordered table-hover">
											<thead>
												<tr>
													<th rowspan="2" style="text-align:left;background-color:#778899;color: white;">#</th>
																													   
													<th rowspan="2" class="center" style="text-align:left;background-color:#778899;color: white;">{% trans %}Goal{% endtrans %}</th>

													
													<th colspan="7" class="center" style="text-align:left;background-color:#778899;color: white;">{% trans %}Achievement{% endtrans %}</th>

												</tr>
												<tr>

													<th style="text-align:left;background-color:#808080;color: white;">Year</th>
													<th style="text-align:left;background-color:#808080;color: white;">Year Total</th>

													<th style="text-align:left;background-color:#808080;color: white;">Quarter 1</th>
													<th style="text-align:left;background-color:#808080;color: white;">Quarter 2</th>
													<th style="text-align:left;background-color:#808080;color: white;">Quarter 3</th>
													<th style="text-align:left;background-color:#808080;color: white;">Quarter 4</th>
												</tr>
											</thead>
											<tbody>
												{% set count =  plan_achievements.getItemNumberPerPage() * (plan_achievements.getCurrentPageNumber() -1) %}
												{% for plan_achievement in plan_achievements %}
													{% set count = count +1 %}
													{% set total = plan_achievement.planAchievements|length + 1 %}
													<tr>
														<td rowspan="{{total}}" style="vertical-align:middle;">{{ count }}</td>
														<td rowspan="{{total}}" style="vertical-align:middle;">{{ plan_achievement.name }}</td>
														
													</tr>
													{% for achievement in plan_achievement.planAchievements %}

														<tr>
															<td>{{ achievement.year}}</td>
															<td>{{ achievement.accomplishmentValue??"0"}}</td>
															{% for quartAccomp in achievement.quarterAccomplishments %}

																<td>{{ quartAccomp.achievementValue??"0" }}</td>
															{% endfor %}
														</tr>
													{% endfor %}

												</tr>
											{% else %}
												<tr>
													<td colspan="3">no records found</td>
												</tr>
											{% endfor %}
										</tbody>
									</table>
									<div class="pull-right" style="" id="custompaginator">{{ knp_pagination_render(plan_achievements) }}</div>
								</div>
							</div>
							{# </div> #}
						</div>
					</div>
				</div>
			</div>

			<div id="messages" class="tab-pane fade">
            <canvas id="myChart" width="400" height="400"></canvas>
            </div>


		</div>
	</div>
</div>{% endblock %}{% block javascripts %}
<script src="{{asset('assets/assets/js/jquery-ui.custom.min.js')}}"></script>
<script src="{{asset('chart.js-3.3.2/package/dist/chart.min.js')}}"></script>
<script>
	$(function () {
$('#reloadbtn').click(function () {
$('#reload').trigger('click');
// $('#reloadform').submit();
})
 function getRandomColor() {
var letters = '0123456789ABCDEF';
var color = '#';
for (var i = 0; i < 6; i++) {
color += letters[Math.floor(Math.random() * 16)];
}
return color;
}
var bgcolor=[];
{% for goal in goalname %}
   bgcolor.push(getRandomColor());
{% endfor %}
//var bgcolor=getRandomColor();
var fillColor=getRandomColor();
var strokeColor=getRandomColor();
var highlightFill=getRandomColor();

var ctx = document.getElementById("myChart").getContext('2d');



var data={
labels: [{{planyear|join(',')}}],
datasets: [
{
label: "{{goalname[0]}}",
fillColor: "rgba(255, 99, 132, 0.1)",
strokeColor: "rgba(220,220,220,0.8)",
highlightFill: "rgba(220,220,220,0.9)",
highlightStroke: "rgba(220,220,220,1)",
data: [65, 59],
backgroundColor: [ 
				bgcolor[0],
				bgcolor[0],
				bgcolor[0],
				'rgba(255, 99, 132, 0.2)',
				'rgba(255, 99, 132, 0.2)',
				'rgba(255, 99, 132, 0.2)'
			],
            borderColor: [ 
				'rgba(255,99,132,1)',
				'rgba(54, 162, 235, 1)',
				'rgba(255, 206, 86, 1)',
				'rgba(75, 192, 192, 1)',
				'rgba(153, 102, 255, 1)',
				'rgba(255, 159, 64, 1)'
			],
			borderWidth: 1 
},
{
label: "{{goalname[1]}}" ,
fillColor: "rgba(151,187,205,0.5)",
strokeColor: "rgba(151,187,205,0.8)",
highlightFill: "rgba(151,187,205,0.75)",
highlightStroke: "rgba(151,187,205,1)",
data: [28, 48],
backgroundColor: [ 
				bgcolor[1],
				bgcolor[1],
				bgcolor[1],
				'rgba(255, 99, 132, 0.2)',
				'rgba(255, 99, 132, 0.2)',
				'rgba(255, 99, 132, 0.2)'
			],
            borderColor: [ 
				'rgba(255,99,132,1)',
				'rgba(54, 162, 235, 1)',
				'rgba(255, 206, 86, 1)',
				'rgba(75, 192, 192, 1)',
				'rgba(153, 102, 255, 1)',
				'rgba(255, 159, 64, 1)'
			],
			borderWidth: 1 
},
{
label: "{{goalname[2]}}",
fillColor: "rgba(151,187,205,0.5)",
strokeColor: "rgba(151,187,205,0.8)",
highlightFill: "rgba(151,187,205,0.75)",
highlightStroke: "rgba(151,187,205,1)",
data: [28, 48],
backgroundColor: [ 
				bgcolor[2],
				bgcolor[2],
				bgcolor[2],
				'rgba(255, 99, 132, 0.2)',
				'rgba(255, 99, 132, 0.2)',
				'rgba(255, 99, 132, 0.2)'
			],
            borderColor: [ 
				'rgba(255,99,132,1)',
				'rgba(54, 162, 235, 1)',
				'rgba(255, 206, 86, 1)',
				'rgba(75, 192, 192, 1)',
				'rgba(153, 102, 255, 1)',
				'rgba(255, 159, 64, 1)'
			],
			borderWidth: 1 
},
{
label: "{{goalname[3]}}",
fillColor: "rgba(151,187,205,0.5)",
strokeColor: "rgba(151,187,205,0.8)",
highlightFill: "rgba(151,187,205,0.75)",
highlightStroke: "rgba(151,187,205,1)",
data: [28, 48],
borderWidth: 1 
},
{
label: "{{goalname[4]}}",
fillColor: "rgba(151,187,205,0.5)",
strokeColor: "rgba(151,187,205,0.8)",
highlightFill: "rgba(151,187,205,0.75)",
highlightStroke: "rgba(151,187,205,1)",
data: [28, 48],
borderWidth: 1 
}
]
};
var myChart = new Chart(ctx, {
    type: 'bar',
    data: data,
    options: {
      responsive: true, // Instruct chart js to respond nicely.
      maintainAspectRatio: false, // Add to prevent default behaviour of full-width/height
    scaleShowGridLines : true,
    }
});

//var barchart=new Chart(ctx).Bar(data);
})
</script>{% endblock %}
